<html>

<head>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cryptography Course Review Note | 3ND</title>
<link rel="shortcut icon" href="https://3nd.xyz/favicon.ico?v=1627826313347">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://3nd.xyz/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="Cryptography Course Review Note | 3ND - Atom Feed" href="https://3nd.xyz/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="C0 考试相关信息
- 题型分布 -

计算题 10' * 6/7
分析题 20' (4)
综合题 20' (2/3)

* 对称 50'/公钥50'.
- 考核范围 -
C1 密码学概论 、C2 密码学基础、C3 古典密码体制、C4 分组..." />
    <meta name="keywords" content="Crypto,Course" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <!--<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>-->
    <script src="/media/highlight.min.js"></script>
</head>

<body>
  <div class="main">
    <div class="main-content">
      <div class="site-header">
  <a href="https://3nd.xyz">
  <img class="avatar" src="https://3nd.xyz/images/avatar.png?v=1627826313347" alt="">
  </a>
  <h1 class="site-title">
    3ND
  </h1>
  <p class="site-description">
    夏が終わった
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    <a href="https://github.com/inspiringz" target="_blank">
      <i class="ri-github-fill"></i>
    </a>
    <a href="mailto:z@3nd.xyz" target="_blank">
      <i class="ri-mail-send-fill"></i>
  </a>
  <a href="#">
    <i class="ri-fire-fill"></i>
</a>
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Cryptography Course Review Note
            </h2>
            <div class="post-info">
              <span>
                2020-01-01
              </span>
              <span>
                42 min read
              </span>
              <span class="page-view" key="20200101134523" title="Cryptography Course Review Note">
              </span>
              
                <a href="https://3nd.xyz/tag/crypto/" class="post-tag">
                  # Crypto
                </a>
                
                <a href="https://3nd.xyz/tag/course/" class="post-tag">
                  # Course
                </a>
                
            </div>
            
                <div class="post-content-wrapper">
                  <div class="post-content">
                    <h2 id="c0-考试相关信息">C0 考试相关信息</h2>
<p><strong>- 题型分布 -</strong></p>
<ul>
<li>计算题 <code>10'</code> * 6/7</li>
<li>分析题 <code>20'</code> (4)</li>
<li>综合题 <code>20'</code> (2/3)</li>
</ul>
<p><strong>*</strong> 对称 <code>50'</code>/公钥<code>50'</code>.</p>
<p><strong>- 考核范围 -</strong></p>
<p>C1 密码学概论 、C2 密码学基础、C3 古典密码体制、C4 分组密码、C5 序列密码</p>
<p>C6 Hash 函数和消息验证、C7 公钥密码体制、C8 数字签名技术、  C9+ 不考</p>
<p><strong>- 教师寄语 -</strong></p>
<p><code>WCJ</code>: 另外，关于考试呢，可能题目比较长，有些题目看起来比较吓人，但是那其实题目长不代表它难，所以咱们同学在考试的时候也要能够去读题，并且能够根据题目把这个他的要求做下来基本上就就能够把这个题目完成了，实际上他没有他看起来那么难。</p>
<h2 id="c1-密码学概述">C1 密码学概述</h2>
<p>信息安全的目标：</p>
<ol>
<li><strong>机密性</strong>：保证信息部泄露给非授权的用户和实体</li>
<li><strong>完整性</strong>：保证信息处于保持完整或为受损的状态，防止对信息特性和状态的中断，窃取篡改，伪造</li>
<li><strong>可用性</strong>：授权用户按需随时访问所需信息而不被非法拒绝</li>
<li><strong>认证性</strong>：确保消息的来源，可分为<strong>消息认证</strong>和<strong>实体认证</strong></li>
<li><strong>不可否认</strong>性：保障用户无法在事后否认曾经对消息的生成、签发、接收</li>
</ol>
<p>密码体制，也称密码系统，5部分组成：</p>
<ul>
<li>明文空间 <code>M</code></li>
<li>密文空间 <code>C</code></li>
<li>密钥空间 <code>K</code>，加密密钥 K<sub>e</sub> 和解密密钥 K<sub>d</sub></li>
<li>加密算法 <code>E</code>，M--&gt;C 的加密变换</li>
<li>解密算法 <code>D</code>，C--&gt;M 的解密变换</li>
</ul>
<p>根据密码分析者对明文、密文等数据资源的掌握程度，可以将<strong>密码分析攻击</strong>分为以下几种：</p>
<ul>
<li><strong>惟密文攻击</strong> -被动攻击  密码分析者仅能根据<strong>截获的密文</strong>进行分析，以得出明文或密钥（破译难度最大）穷举和统计分析都是惟密文攻击</li>
<li><strong>已知明文攻击</strong> -被动攻击  密码分析者除了有截获的密文外，还有一些已知的<strong>明文--密文对</strong>来破译密码</li>
<li><strong>选择明文攻击</strong> -主动攻击  密码分析者除得到一些“明文-密文对”外，还可以选择<strong>加密的明文</strong>，并获得<strong>相应的密文</strong>  攻击者短暂控制加密机</li>
<li><strong>选择密文攻击</strong> -主动攻击  密码分析者可以<strong>选择一些密文</strong>，并获得<strong>相应的明文</strong> 攻击者控制解密机，多用于攻击<strong>公钥密码体制</strong></li>
<li><strong>选择文本攻击</strong> -主动攻击  密码分析者同时控制加密机和解密机</li>
</ul>
<p>密码体制安全性：</p>
<ul>
<li><strong>无条件安全</strong>（理论安全性）  即使密码分析者具有无限的计算能力，密码体制也不能被攻破</li>
<li><strong>计算安全性</strong>  攻破一个密码体制的最好算法用现在或将来可得到的资源不能再足够长的时间内破译</li>
<li><strong>可证明安全性</strong>（规约安全性）  密码体制的安全和一个问题是相关的</li>
</ul>
<h2 id="c3-古典密码体制">C3 古典密码体制</h2>
<pre><code>* 能够清楚给出明文对其加密或者给出密文对其破解
* 单表和多表的形式
* 典型的古典密码的密钥空间问题，安全性
* 重合指数等不会考
</code></pre>
<p><strong>- 经典密码的定义和分类 -</strong></p>
<p>经典密码体制都是<strong>对称密码体制</strong>，密钥由安全信道传递，可分为：代换密码与置换密码。</p>
<h3 id="代换密码">代换密码</h3>
<p><strong>代换密码</strong>/替换密码（<strong>S</strong>ubstitution）—用一个符号代替另一个符号。</p>
<p>代换密码根据预先建立的<strong>替换表</strong>，将明文依次通过<strong>查表</strong>，替换为相应字符，生成密文，替换密码的<strong>密钥</strong>就是<strong>替换表</strong></p>
<ul>
<li>
<p><strong>单表替换密码</strong>——使用一个固定的替换表：明文、密文字符<strong>一一对应</strong></p>
<p><strong>- 密码分析 -</strong> 穷举分析、统计特性(字母出现的频率)。</p>
<ul>
<li><strong>凯撒密码</strong>
<ul>
<li>加密：c = (m + k) mod 26</li>
<li>解密：m = (c - k) mod 26</li>
<li>密钥空间: <strong>26</strong></li>
</ul>
</li>
<li><strong>乘数密码</strong>
<ul>
<li>加密：c = (m * k) mod q</li>
<li>解密：m = (c * k<sup>-1</sup>) mod q</li>
<li>密钥空间: <strong>phi(26)</strong> = phi(2) * phi(13) = 1 * 12 = 12</li>
</ul>
</li>
<li><strong>仿射密码</strong> -- 移位密码 &amp; 乘数密码
<ul>
<li>选取 k_1，k_2 两个参数，其中 gcd(k_1, 26)=1</li>
<li>加密：c = k_1 * m + k_2 mod 26
<ul>
<li>k_1 = 1 时 -&gt; 移位密码</li>
<li>k_2 = 1 时 -&gt; 乘数密码</li>
</ul>
</li>
<li>解密：m = (c - k_2) * k_1<sup>-1</sup> mod 26</li>
<li>密钥空间: n = 26 时 -&gt; <strong>12*26-1</strong></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>多表替换密码</strong>——使用多个替换表</p>
<p><strong>提高代换密码强度的一种方法是采用多个密文字母表，使密文中的每一个字母有多种可能的字母来代替</strong></p>
<p><strong>- 密码分析 -</strong><br>
<strong>-</strong> 确定密钥长度 -- 确定使用的加密表个数: Kasiski 测试法、重合指数法。<br>
<strong>-</strong> 确定具体的密钥字: 重合互指数。</p>
<ul>
<li>
<p><strong>Playfair</strong></p>
<ul>
<li>
<p>思想: 双字母转换, (一次一密: 每个明文字母都采用不同的替换表或密钥进行加密)</p>
</li>
<li>
<p>密钥: 5×5矩阵（由一个关键词构造，<strong>I/J</strong> 视为相同）</p>
<p>KEY -&gt; 去重 -&gt; 填充 <strong>5*5</strong> 矩阵，eg: <strong>FIVESTARS</strong></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://3nd.xyz/post-images/move/2020-01-01-13-56-31.png" alt="" loading="lazy"></figure>
<pre><code>- 加密：对每一**对**明文 m1, m2 加密如下：

1. 若 m1 和 m2 同行，则密文 c1 和 c2 分别紧靠 m1，m2 **右端**的字母，其中第一列看做最后一列的右方。

2. 若 m1 和 m2 同列，则密文 c1 和 c2 分别是紧靠 m1，m2 **下方**的字母，其中第一行看做最后一行的下方。

3. 若 m1 和 m2 不同行也不同列，则 c1 和 c2 是 m1，m2 确定的矩形的其他**两角**的字母，并 c1 和 m1 ，c2 和 m2 同行。

4. 若出现**重复**字母，即 𝑚1 = 𝑚2，则在其中插入字母 **Q**，eg: LLY -&gt; L**Q**LY。

5. 如明文字母是**单数**，将 Q 放在明文的末端, eg: ABC -&gt; ABC**Q**。
```py
m = Pl ay fa ir ci ph er wa sa ct ua ll y 
  = Pl ay fa ir ci ph er wa sa ct ua lq ly
c = QK BW IT VA AS OK VB IG IC TA WT QZ KZ
```
- 密钥空间：**25!**
</code></pre>
<ul>
<li>
<p><strong>Vigenère</strong></p>
<ul>
<li>26 * 26 的方阵</li>
<li>密钥: k = k_1, k_2, ... , k_n</li>
<li>明文: m = m_1, m_2, ... , m_n</li>
<li>加密: c_i = m_i + k_i mod 26</li>
<li>解密: m_i = c_i - k_i mod 26</li>
</ul>
</li>
<li>
<p><strong>Hill密码</strong></p>
<ul>
<li>密钥：k = n * n 可逆矩阵</li>
<li>明文 m 和密文 c 均为 <strong>n维向量</strong></li>
<li>加密：c = k * m mod 26</li>
<li>解密：m = k<sup>-1</sup> * c mod 26</li>
<li>k<sup>-1</sup> 为 k 在模 26 上的逆矩阵</li>
</ul>
</li>
</ul>
<h3 id="置换密码">置换密码</h3>
<p><strong>置换密码</strong>/换位密码（Permutation）—对符号进行重新排序</p>
<p>置换密码：明文字符集保持不变，但顺序被打乱.</p>
<h2 id="c4-分组密码">C4 分组密码</h2>
<pre><code class="language-sh">* DES和AES的相关规则，方式方法，思想
* DES的结构，加密解密思想，验证正确性
* 把加密解密结构图画出来，用数学符号写出过程并证明
* DES对合运算，加解密过程怎样可以是完全一样的，用数学符号实现证明
* DES中p盒，s盒规则，根据实例，写出中间计算的结果
* DES，2des，3des安全性能分析，明文空间，密文空间，密钥空间
* AES安全性能分析，明文空间，密文空间，密钥空间，加解密过程，同上，对字上面的加法乘法进行运算
* IDEA明文密文密钥空间以及安全性能
* 工作模式：ECB，CBC，CFB，OFB，CTR能够用图表示出来，并且能用数学符号表示出来，性能分析，尤其是对其错误传播率，基本效率和安全性能
</code></pre>
<p><strong>- 分组密码概述 -</strong></p>
<p>将明文划分成长为 𝑚 (如 𝑚=64 或 128 )的分组 𝑃＝(𝑝0, 𝑝1, 𝑝2, ….,𝑝_(𝑚−1))，各明文分组分别在长为 t 的密钥 𝐾＝(𝑘0, 𝑘1, 𝑘2, ….,𝑘_(𝑡−1)) 的控制下变换成长为 𝑛 的密文分组 𝐶＝(𝑐0, 𝑐1, 𝑐2, …,𝑐_(𝑛−1))。(一般 𝑚=𝑛)</p>
<p><strong>- 特点 -</strong></p>
<p>速度快、安全性较高、易于标准化和便于软硬件实现，是信息与网络安全中实现数据保密性的<strong>核心机制</strong>，在计算机通信和信息系统安全领域有着广泛应用。也是构造伪随机数生成器、序列密码、消息认证码和 Hash 函数的方法。</p>
<p><strong>- 设计要求 -</strong></p>
<p>分组长度要足够大、密钥量要足够大、密码变换要足够复杂、加密和解密运算简单、无数据扩展和压缩。</p>
<p><strong>- 混淆与扩散 -</strong></p>
<ul>
<li>
<p>混淆(Confusion)：是一种使密钥与密文之间的关系尽可能模糊的加密操作。如今实现混淆常用的一个元素就是<strong>替换</strong>，这个元素在 DES 和 AES 中都有使用。</p>
</li>
<li>
<p>扩散(Diffusion)：是一种为了隐藏明文的统计属性而将一个明文符号的影响扩散到多个密文的加密操作。最简单的扩散元素就是<strong>位置换</strong>，它常用于 DES 中；而 AES 则使用更高级的 Mixcolumn 操作。</p>
</li>
</ul>
<h3 id="数据加密标准-des">数据加密标准 - DES</h3>
<p><strong>- 算法描述 -</strong></p>
<ol>
<li>
<p>明密文分组均为 <strong>64-bit</strong>，有效密钥长度为 <strong>56-bit</strong>.</p>
</li>
<li>
<p>由<strong>初始置换、16轮迭代、逆初始置换</strong>组成.</p>
</li>
<li>
<p>加解密算法相同，只是解密子密钥和加密子密钥的<strong>使用顺序相反</strong>.</p>
</li>
</ol>
<p><strong>- Festial 结构 -</strong> 要求会画</p>
<figure data-type="image" tabindex="2"><img src="https://3nd.xyz/post-images/move/2020-01-01-14-51-15.png" alt="" loading="lazy"></figure>
<p><strong>- 数学描述 -</strong></p>
<p>初始置换：<span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \- at position 28: …leftarrow IP(64\̲-̲bits \ m)'>L_{0}R_{0} \leftarrow IP(64\-bits \ m)</span><br>
16 轮迭代：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>←</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>R</mi><mi>i</mi></msub><mo>←</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><mi>F</mi><mo>(</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo>)</mo><mtext>  </mtext><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">L_{i} \leftarrow R_{i-1}, R_{i} \leftarrow L_{i-1} \oplus F(R_{i-1}, K_{i}) \ \ i = 1, 2, ..., 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mspace"> </span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">6</span></span></span></span><br>
逆初始置换：<span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \- at position 3: 64\̲-̲bit \ c \leftar…'>64\-bit \ c \leftarrow IP^{-1}(R_{16}, L_{16})</span></p>
<p><strong>- ▲ DES 对合性 &amp; 可逆性 -</strong></p>
<ol>
<li>可逆性证明</li>
</ol>
<ul>
<li><strong>定义</strong> 变换 T 是把 64 位数据的左右两部分交换位置<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>(</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo>)</mo><mo>=</mo><mo>(</mo><mi>R</mi><mo separator="true">,</mo><mi>L</mi><mo>)</mo><mo separator="true">,</mo><msup><mi>T</mi><mn>2</mn></msup><mo>(</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo>)</mo><mo>=</mo><mi>T</mi><mo>(</mo><mi>R</mi><mo separator="true">,</mo><mi>L</mi><mo>)</mo><mo>=</mo><mo>(</mo><mi>L</mi><mo separator="true">,</mo><mi>R</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">T(L, R) = (R, L), T^2(L, R) = T(R, L) = (L, R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span> 则 T 变换为对合变换。</li>
<li>记 DES 第 i 轮中的主要运算为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span> ，即<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub><mo>(</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>=</mo><mo>(</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><msub><mi>F</mi><mi>i</mi></msub><mo>(</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo>)</mo><mo separator="true">,</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">F_{i}(L_{i-1}, \ R_{i-1}) = (L_{i-1} \oplus F_{i}(R_{i-1}, K_i), R_{i-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;EOF&#039; at end of input: …i-1}), R_{i-1})'>{F_{i\}\}^{2} = (F_{i}(L_{i-1} \oplus F_{i}(R_{i-1}, K_i), R_{i-1}), R_{i-1})</span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mo>(</mo><mo>(</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⊕</mo><mi>F</mi><mo>(</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo>)</mo><mo>)</mo><mo>⊕</mo><mi>F</mi><mo>(</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>K</mi><mi>i</mi></msub><mo>)</mo><mo separator="true">,</mo><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">= ((L_{i-1} \oplus F(R_{i-1}, K_i)) \oplus F(R_{i-1}, K_i), R_{i-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mo>(</mo><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">=(L_{i-1}, \ R_{i-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;EOF&#039; at end of input: … {F_{i\}\}^{-1}'>F_{i} = {F_{i\}\}^{-1}</span><br>
则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span> 为对合变换。</li>
<li>结合 1 、2 构成 DES 的轮运算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub><mo>=</mo><msub><mi>F</mi><mi>i</mi></msub><mi>T</mi></mrow><annotation encoding="application/x-tex">H_{i} = F_{i}T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>F</mi><mi>i</mi></msub><mi>T</mi><mo>)</mo><mo>(</mo><mi>T</mi><msub><mi>F</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><mo>(</mo><msub><mi>F</mi><mi>i</mi></msub><mo>(</mo><mi>T</mi><mi>T</mi><mo>)</mo><msub><mi>F</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><msub><mi>F</mi><mi>i</mi></msub><msub><mi>F</mi><mi>i</mi></msub><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">(F_{i}T)(TF_{i}) = (F_{i}(TT)F_{i}) = F_{i}F_{i} = I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span><br>
则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>F</mi><mi>i</mi></msub><mi>T</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mo>(</mo><mi>T</mi><msub><mi>F</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(F_{i}T)^{-1}=(TF_{i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>F</mi><mi>i</mi></msub><mi>T</mi><mo>)</mo><mo>=</mo><mo>(</mo><mi>T</mi><msub><mi>F</mi><mi>i</mi></msub><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">(F_{i}T)=(TF_{i})^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><br>
则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">H_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为对合变换。</li>
</ul>
<h4 id="初始置换ip逆初始置换ipsup-1sup">初始置换IP/逆初始置换IP<sup>-1<sup></h4>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">IP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span></span></span></span> 在第一轮迭代之前进行，目的是将原明文块的<strong>位</strong>进行换位操作（查表）。</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><msup><mi>P</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">IP^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 在最后一轮迭代之后进行，在加密算法中输出为密文，在解密算法中输出明文。</p>
<h4 id="16-轮迭代">16 轮迭代</h4>
<p>在每轮迭代中，64-bit 的中间结果被分成左右两部分，且作为相互独立的 32-bit 数据进行处理。每轮迭代的输入是上轮的结果 L<sub>i-1</sub> 和 R<sub>i-1</sub>.</p>
<figure data-type="image" tabindex="3"><img src="https://3nd.xyz/post-images/move/2020-01-01-15-50-05.png" alt="" loading="lazy"></figure>
<h4 id="f-函数"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 函数</h4>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 函数在 DES 的安全性中扮演着重要的角色，在第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> 轮中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 函数的输入为前一轮输出的右半部分 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">L_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 和当地前轮密钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 函数的输出将用作 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mi>O</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">XOR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>-掩码，用来加密左半部分输入 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">L_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>。</p>
<ul>
<li>
<p>E-盒拓展置换</p>
<p>首先将<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">R_{i-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 32-bit输入分为 8 个 4-bit 的分组，然后把每个分组拓展为 6-bit，从而将 32 位的输入拓展为 48 位。这个过程在 <code>E-盒</code> 中进行，E-盒 是一个特殊的置换，第一个分组包含的位为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>4</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(1, 2, 3, 4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">4</span><span class="mclose">)</span></span></span></span>，第二个分组包含的位为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>5</mn><mo separator="true">,</mo><mn>6</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>8</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(5, 6, 7, 8)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mclose">)</span></span></span></span>, 以此类推。</p>
</li>
<li>
<p>S-盒混淆替换</p>
<p>接着将 E-盒 拓展得到的 48 位的结果与轮密钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 进行 XOR 操作，并将 8 个 6 位长的分组送到 8 个不同的替换盒中——这个替换盒也称为 <code>S-盒</code>，每个 S-盒 都是一个查找表，它将 6 位的输入映射为 4 位的输出。</p>
<p>每个 6 为的输入位的最重要的位 <code>MSB</code> 和最不重要位 <code>LSB</code> 将选择表行，而 4 个内部位，则选择列。</p>
</li>
</ul>
<figure data-type="image" tabindex="4"><img src="https://3nd.xyz/post-images/move/2019-12-26-16-57-29.png" alt="" loading="lazy"></figure>
<p>从密码学的角度来讲，S-盒 是 DES 的核心，也是该算法中唯一的非线性元素，并提供了<strong>混淆</strong>。</p>
<ul>
<li>
<p>P 置换</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 函数中每轮 S-盒 替换后的简单置换操作。</p>
</li>
</ul>
<h4 id="密钥编排">密钥编排</h4>
<p>DES 子密钥是从初始密钥(种子密钥)产生的，种子密钥 𝐾 为 64-bit，其中有 8-bit 用于奇偶校验，因此 DES 的密钥实际上只有<strong>56-bit</strong>.密钥编排从原始的 56 位密钥中得到 16 个轮密钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，其中每个轮密钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 都是 48 位。轮密钥的另一个术语叫 子密钥。</p>
<ul>
<li>
<p>初始密钥置换 PC-1 / 64-bits -&gt; 56-bits</p>
</li>
<li>
<p>轮密钥置换 PC-2 / 返回 key_i</p>
</li>
</ul>
<h4 id="des-安全性">DES 安全性</h4>
<p>DES 安全性的主要争议：</p>
<ul>
<li>对 DES 的 S 盒、迭代次数、密钥长度等设计准则的争议</li>
<li>DES 存在一些弱密钥和半弱密钥</li>
<li>DES 的 56-bit 密钥无法抵抗穷举攻击</li>
<li>DES 代数结构存在互补对称性</li>
</ul>
<p>主要安全问题：</p>
<ul>
<li>
<p>互补性<br>
<strong>选择明文攻击</strong>下工作量减半 (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>56</mn></msup><mo>→</mo><msup><mn>2</mn><mn>55</mn></msup></mrow><annotation encoding="application/x-tex">2^{56} \rightarrow 2^{55}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span>)<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo>(</mo><mi>m</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">c_{1} = E_{k}(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo>(</mo><mover accent="true"><mi>m</mi><mo stretchy="true">‾</mo></mover><mo>)</mo></mrow><annotation encoding="application/x-tex">c_{2} = E_{k}(\overline {m})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.63056em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.55056em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> <span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;EOF&#039; at end of input: …\overline k}(m)'>\rightarrow \overline {c_{2\}\} = E_{\overline k}(m)</span><br>
穷举密钥 k, 密文为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">c_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 则找到密钥 k, 密文为 $\overline c_{2} $ 则找到密钥的补 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>k</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.89444em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.89444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span><span style="top:-3.81444em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>。</p>
</li>
<li>
<p>2DES</p>
<p>双重 DES <strong>中间相遇攻击</strong> 牺牲空间来换取时间，可使得复杂度 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>112</mn></msup><mo>→</mo><msup><mn>2</mn><mn>57</mn></msup></mrow><annotation encoding="application/x-tex">2^{112} \rightarrow 2^{57}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span></span></span></span>。<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-16-49-40.png" alt="" loading="lazy"><br>
明文 P, 密文 C, 使用所有的密钥 <code>k</code> 加密 P, 结果存放到 T 表中，使用所有的密钥 <code>k'</code> 解密 C 与 T 表中的值进行比较，若相等则用测试的两个密钥对 P 进行加密，如结果为 C 则找到密钥。</p>
</li>
<li>
<p>3DES<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-16-50-40.png" alt="" loading="lazy"></p>
<ul>
<li>
<p>EEE3/EDE3 -&gt; 3 * 56-bit</p>
</li>
<li>
<p>EEE2/EDE2 -&gt; 2 * 56-bit</p>
</li>
</ul>
</li>
</ul>
<h3 id="高级加密标准-aes">高级加密标准 - AES</h3>
<p>分组长度 <strong>128-bit</strong>，密钥长度可以为 <strong>128/192/256-bit</strong>，一般使用密钥长度 <strong>128-bit</strong>，迭代轮数为 <strong>10</strong> 轮.</p>
<p>AES 的处理单位为 <strong>字节</strong>(1-byte = 8-bit)，128-bit 的明文分组和输入密钥都被分为 16-byte，一般明文分组用以字节为单位的正方形矩阵描述，称为<strong>状态矩阵</strong>，算法的每一轮中，状态矩阵的内容不断发生变化，最后的结果作为密文输出。</p>
<p><strong>- AES 加密框图 -</strong></p>
<figure data-type="image" tabindex="5"><img src="https://3nd.xyz/post-images/move/2020-01-01-16-36-53.png" alt="" loading="lazy"></figure>
<p>解密流程为加密的逆流程。</p>
<figure data-type="image" tabindex="6"><img src="https://3nd.xyz/post-images/move/2020-01-01-17-44-20.png" alt="" loading="lazy"></figure>
<p>AES 每轮由 4 个阶段组成：</p>
<ul>
<li>
<p>字节代换层</p>
</li>
<li>
<p>ShiftRows 层 / 行移位</p>
</li>
<li>
<p>MixColumn 层 / 列混合</p>
</li>
<li>
<p>密钥加法层</p>
</li>
</ul>
<p><strong>第一轮开始前进入密钥加法层与原始密钥异或，最后一轮次不进行列混合。</strong></p>
<h4 id="字节代换层s-box">字节代换层(S-Box)</h4>
<p>简单的查表，4-byte * 4-byte 组成的矩阵，每个元素的内容是一个字节的值。</p>
<h4 id="shiftrows-行移位">ShiftRows 行移位</h4>
<p>左循环移位，第 0 行不变，第 1 行左移 1 个字节，第 2 行左移 2 个字节，第 3 行左移 3 字节。</p>
<figure data-type="image" tabindex="7"><img src="https://3nd.xyz/post-images/move/2020-01-01-16-57-17.png" alt="" loading="lazy"></figure>
<h4 id="mixcolumn-列混合">MixColumn 列混合</h4>
<p>对一个状态逐<strong>列</strong>进行变换，矩阵元素的加法和乘法都是定义在基于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub><mo>[</mo><mi>𝑥</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">Z_2[𝑥]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span>中的不可约多项式为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑚</mi><mo>(</mo><mi>𝑥</mi><mo>)</mo><mo>=</mo><msup><mi>𝑥</mi><mn>8</mn></msup><mo>+</mo><msup><mi>𝑥</mi><mn>4</mn></msup><mo>+</mo><msup><mi>𝑥</mi><mn>3</mn></msup><mo>+</mo><mi>𝑥</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">𝑚(𝑥) = 𝑥^8+𝑥^4+𝑥^3+𝑥+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 构造的GF(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>8</mn></msup></mrow><annotation encoding="application/x-tex">2^8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span>)上的二元运算，加法等价于两个字节的异或.</p>
<p>乘法: 将每列视为有限域GF(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>8</mn></msup></mrow><annotation encoding="application/x-tex">2^8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span></span>)上的一个多项式。</p>
<p><img src="https://3nd.xyz/post-images/move/2020-01-01-17-14-13.png" alt="" loading="lazy"><br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-17-39-31.png" alt="" loading="lazy"><br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-17-14-31.png" alt="" loading="lazy"></p>
<ul>
<li>乘 0x01 -&gt; 不变</li>
<li>乘 0x02
<ul>
<li>最高位为 0，直接左移一位</li>
<li>最高位为 1，左移一位后与<code>0001 1011</code> 异或</li>
</ul>
</li>
<li>乘 0x03，<code>0000 0011</code>= <code>0000 0010</code>⊕<code>0000 0001</code><br>
乘以 0x03 可以拆为分别称为 0x01 和 0x02，再将结果异或.<br>
eg: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>00000011</mn><mo>)</mo><mi mathvariant="normal">∙</mi><mo>(</mo><msub><mi>𝑎</mi><mn>7</mn></msub><msub><mi>𝑎</mi><mn>6</mn></msub><msub><mi>𝑎</mi><mn>5</mn></msub><msub><mi>𝑎</mi><mn>4</mn></msub><msub><mi>𝑎</mi><mn>3</mn></msub><msub><mi>𝑎</mi><mn>2</mn></msub><msub><mi>𝑎</mi><mn>1</mn></msub><msub><mi>𝑎</mi><mn>0</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(0000 0011)∙(𝑎_7 𝑎_6 𝑎_5 𝑎_4 𝑎_3 𝑎_2 𝑎_1 𝑎_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span><span class="mclose">)</span><span class="mord">∙</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
$ =[(0000 0010) ⊕ (0000 0001)] ∙(𝑎_7 𝑎_6 𝑎_5 𝑎_4 𝑎_3 𝑎_2 𝑎_1 𝑎_0)<span class="katex"><span class="katex-mathml"><math><semantics><mrow></mrow><annotation encoding="application/x-tex">
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span> =[(0000 0010) ∙(𝑎_7 𝑎_6 𝑎_5 𝑎_4 𝑎_3 𝑎_2 𝑎_1 𝑎_0)] ⊕ (𝑎_7 𝑎_6 𝑎_5 𝑎_4 𝑎_3 𝑎_2 𝑎_1 𝑎_0)$</li>
</ul>
<h4 id="密钥加法层-轮密钥加">密钥加法层 轮密钥加</h4>
<p>将轮密钥与<strong>状态</strong>按比特进行异或运算。</p>
<h4 id="密钥扩展">密钥扩展</h4>
<p>包括两个部分：<strong>密钥扩展</strong> 和 <strong>轮密钥选取</strong></p>
<p>首先将种子密钥输入到 4x4 矩阵中，每列组成一个字，w[0]，w[1]，w[2]，w[3]</p>
<p>对 w 数组扩展 40 个新列构成 44 列的密钥数组:</p>
<ul>
<li>若 i 不是 4 的倍数，那么 w[i] = w[i-4] ⊕ w[i-1]</li>
<li>若 i 是 4 的倍数，那么 w[i] = w[i-4] ⊕ T(w[i-1])</li>
</ul>
<p>T 函数，由字循环、字代替和轮常量异或组成:</p>
<ul>
<li>字循环：将一个字的 4 个字节循环左移一个字节.</li>
<li>字节代换：对字循环的结果使用 S 盒进行字节代换.</li>
<li>轮常量异或：将前两步的几个同轮常量 Rcon[j](轮数)进行异或.</li>
</ul>
<h3 id="典型的分组密码">典型的分组密码</h3>
<ol>
<li>IDEA 国际数据加密算法(International Data Encryption Algorithm)</li>
</ol>
<p>明文分组长度 <strong>64-bit</strong>，密钥长度 <strong>128-bit</strong>，迭代 <strong>8 轮</strong>，构成<strong>64-bit</strong>的密文块。</p>
<ol start="2">
<li>SMS4</li>
</ol>
<p>分组长度 <strong>128-bit</strong>，密钥长度 <strong>128-bit</strong>，加密算法与密钥扩展算法都采用 <strong>32 轮</strong>非线性迭代结构。</p>
<h3 id="工作模式">工作模式</h3>
<ul>
<li>
<p><code>电码本模式</code>(<strong>ECB</strong> ，Electronic Code Book)</p>
<p>直接用分组密码算法来进行消息的加密和解密，根据算法对明文进行分组，必要可进行填充(Padding)，一个明文分组被加密成一个密文分组，<strong>相同的明文分组加密成相同的密文分组</strong>。<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-18-20-33.png" alt="" loading="lazy"><br>
<strong>- 特点 -</strong></p>
<ul>
<li>操作简单，主要用于内容<strong>较短且随机</strong>的报文的加密，可进行并行运算，速度快；</li>
<li>相同明文（在相同密钥下）得出相同的密文，即明文中的重复内容将在密文中表现出来，容易实现<strong>统计分析攻击</strong>、<strong>位图攻击</strong>、<strong>分组重放攻击</strong>和<strong>代换攻击</strong>；</li>
<li><strong>链接依赖性</strong>：各组的加密都独立于其它分组，可实现并行处理；</li>
<li><strong>错误传播</strong>：单个密文分组中有一个或多个比特错误只会影响该分组的解密结果。</li>
</ul>
</li>
<li>
<p><code>密码分组链接模式</code>(<strong>CBC</strong> ，Clipher Block Chaining)<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-18-20-52.png" alt="" loading="lazy"><br>
* 通过引入一些随机化，尤其是<strong>初始向量(Initialization Vector, IV)<strong>来实现</strong>概率加密</strong>。</p>
<ol>
<li>所有分组的加密都链接在一起，每个密文分组不仅依赖于产生它的明文分组，还依赖于它前面的所有分组；</li>
<li>加密过程中使用初始向量(IV)进行<strong>随机化</strong>，实现概率加密(每次加密相同的明文都会得到不同的密文)。</li>
<li><strong>链接依赖性</strong>：对于一个正确密文分组的正确解密要求它之前的那个密文分组也正确，不能实现<strong>并行</strong>处理；</li>
<li><strong>错误传播</strong>：密文分组中的一个单比特错误会影响到本组和其后分组的解密，错误传播为两组；</li>
<li>初始化向量 IV 不需要保密，它可以明文形式与密文一起传送。</li>
</ol>
</li>
<li>
<p><code>输出反馈模式</code>(<strong>OFB</strong>，Output Feedback)</p>
<p>首先使用分组密码加密 IV，得到的密钥输出为 b 位密钥序列的第一个集合，将前一个密钥输出反馈给分组密码进行加密，即可计算出密钥序列的下一个分组，不断重复这个过程。</p>
</li>
</ul>
<figure data-type="image" tabindex="8"><img src="https://3nd.xyz/post-images/move/2020-01-01-18-21-42.png" alt="" loading="lazy"></figure>
<p>OFB 模式形成了一个同步序列密码，密钥序列不依赖与明文，也不依赖与密文。</p>
<ul>
<li>
<p><code>密码(文)反馈模式</code>(<strong>CFB</strong>，Cipher Feedback)</p>
<p>与 OFB 相同的是 CFB 也使用了反馈，与 OFB 不同的是，OFB 反馈的是分组密码的输出，CFB 反馈的是密文的输出，密钥序列以分组方式产生。<br>
要生成第一个密钥序列 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，必须先加密 IV，而所有后续密钥序列分组 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>3</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">s_2, s_3,...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span> 都是通过加密前一个密文得到的。</p>
</li>
</ul>
<figure data-type="image" tabindex="9"><img src="https://3nd.xyz/post-images/move/2020-01-01-18-19-09.png" alt="" loading="lazy"></figure>
<p>优点：自同步能力强，可以处理任意长度的消息。<br>
缺点：<br>
- 明文某一组中有错，使以后的密文组都受影响，但经解密后，除原有误的一组外，其后各组都正确地恢复。<br>
- 密文里的一位错误会引起明文的一个单独错误，此错误进入移位寄存器，导致密文成为无用信息，直到该错误从移位寄存器中移出。</p>
<ul>
<li>
<p><code>计数器模式</code>(<strong>CTR</strong>，Counter)</p>
<p>使用分组密码作为序列密码的另一种模式就是计数器(CTR)模式，与  OFB 和 CFB 模式一样，密钥序列也是以分组方式计算的，分组密码的输入为一个计数器，每当分组密码计算一个新的密钥序列时，该计数器都会产生一个不同的值。</p>
</li>
</ul>
<figure data-type="image" tabindex="10"><img src="https://3nd.xyz/post-images/move/2020-01-01-18-31-11.png" alt="" loading="lazy"></figure>
<p>优点：不需要任何反馈，可以实现并行化。</p>
<h2 id="c5-序列密码">C5 序列密码</h2>
<pre><code>* 线性移位反馈寄存器，根据反馈函数或者本原多项式或者联系多项式，给出输出序列，周期，性能
* 序列密码随机性能的问题，对几个指标进行分析
* 不会单独考核算法
</code></pre>
<p><strong>- 概述 -</strong></p>
<p>使用<strong>随机序列（密钥流）<strong>与<code>明文</code>序列</strong>按位叠加</strong>产生密文，同时用<strong>同一随机序列</strong>与<code>密文</code>序列叠加可恢复明文。</p>
<p><strong>- 密钥流要求 -</strong></p>
<ol>
<li><strong>极大的周期</strong><br>
真正的随机序列是非周期的，但算法产生的序列都是存在周期的。</li>
<li><strong>良好的统计特性</strong><br>
随机序列有均匀的<strong>游程分布</strong>
<ul>
<li><strong>游程</strong> 称序列中<strong>连续的 i 个 1</strong> 为 长度等于 <code>i</code> 的 <code>1</code> 游程， 同样，称序列中连续的 <code>i</code> 个 <code>0</code> 为长度等于 <code>i</code> 的 <code>0</code> 游程，如 <code>……0 111 0000 10……</code> 有长为 3 的 1 游程，长为 4 的 0 游程，长为 1 的 1 游程。</li>
<li>一般要求周期内满足<strong>同样长度</strong>的<code>0游程</code>和<code>1游程</code>的个数相等或近似相等。</li>
</ul>
</li>
<li><strong>良好的线性复杂度</strong><br>
不能用级数较小的线性反馈移位寄存器近似代替.</li>
<li>用统计方法由密钥序列提取<strong>密钥生成器结构</strong>或<strong>种子密钥</strong>在<strong>计算上不可行</strong>.</li>
</ol>
<h3 id="线性反馈移位寄存器-lfsr">线性反馈移位寄存器 - LFSR</h3>
<p>实际序列密码使用的密钥位序列 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">s_{1}, s_{2}, ...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span> 是通过具有某种属性的密钥流生成器得到的。一种得到长伪随机序列的简单方法就是使用<strong>线性反馈移位寄存器</strong>（LFSR）, LFSR 很容易使用硬件实现，许多序列密码都是使用 LFSR 来实现的，但不是全部。</p>
<p>一个 LFSR 有若干时钟存储原件（触发器）和一个反馈路径组成，存储原件的数目给出了 LFSR 的<strong>度</strong>。换言之，一个拥有 m 个触发器的 LFSR 可以称为<code>度为 m</code>。反馈网络计算移位寄存器中某些触发器的 XOR 和，并将其作为上一个触发器的输入。</p>
<figure data-type="image" tabindex="11"><img src="https://3nd.xyz/post-images/move/2019-12-25-22-43-20.png" alt="" loading="lazy"></figure>
<p>如果这里的反馈函数是线性的，我们则将其称为 LFSR，此时该反馈函数可以表示为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo>)</mo><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>a</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>⊕</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>⊕</mo><msub><mi>c</mi><mi>n</mi></msub><msub><mi>a</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">f(a_{1},a_{2}, ..., a_{n}) = c_{1}a_{1} \oplus c_{2}a_{2} \oplus ... \oplus c_{n}a_{n}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">c_{i}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>或<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⊕</mo></mrow><annotation encoding="application/x-tex">⊕</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">⊕</span></span></span></span>表示异或（模二加）。</p>
<p>LFSR 寄存器的空间状态受限于寄存器位数最大只能达到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>，去除初始状态之后有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{n}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 即可到达循环节。</p>
<p><strong>&gt;&gt; 度长为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 的 LFSR 可产生的最大周期序列长度为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>m</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{m}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></strong>.</p>
<p>只要选择合适的连接多项式便可使线性移位寄存器的 输出序列周期达到最大值 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span> –1，并称此时的输出序列为<strong>最大长度线性移位寄存器输出序列</strong>，简称为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 序列。</p>
<ul>
<li>例1 求输出序列及周期</li>
</ul>
<figure data-type="image" tabindex="12"><img src="https://3nd.xyz/post-images/move/2020-01-01-21-19-33.png" alt="" loading="lazy"></figure>
<ul>
<li>
<p>例2 <strong>m-序列密码的破译</strong></p>
<p>设敌手得到密文串<code>10110 10111 10010</code>和相应的明文串<code>01100 11111 11001</code>，因此可计算出相应的密钥流为<code>11010 01000 01011</code>(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo>⊕</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">c \oplus m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>)。进一步假定敌手还知道密钥流是使用 <code>5</code> 级线性反馈移位寄存器产生的，那么敌手可分别用<strong>密文</strong>串中的前 10-bit 和<strong>明文</strong>串中的前 10-bit 建立如下方程:<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-21-34-34.png" alt="" loading="lazy"><br>
即<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-21-35-36.png" alt="" loading="lazy"><br>
而<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-21-39-35.png" alt="" loading="lazy"><br>
从而得到<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-21-40-03.png" alt="" loading="lazy"><br>
有<br>
<img src="https://3nd.xyz/post-images/move/2020-01-01-21-40-42.png" alt="" loading="lazy"><br>
密钥流的递推关系为：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>5</mn></mrow></msub><mo>=</mo><msub><mi>c</mi><mn>5</mn></msub><msub><mi>a</mi><mi>i</mi></msub><mo>⊕</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>3</mn></mrow></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mo>⊕</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>+</mo><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i+5} = c_5 a_i \oplus c_2 a_{i+3} = a_i \oplus a_{i+3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>.<br>
<strong>- 逆矩阵求解 -</strong><br>
给 A 的右边拼一个同阶单位阵<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>E</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">[A|E]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mclose">]</span></span></span></span>，然后通过<strong>行变换</strong>把左边变位单位阵，这时右边的就是 A 的逆矩阵 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mi>E</mi><mi mathvariant="normal">∣</mi><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>]</mo></mrow><annotation encoding="application/x-tex">[E|A^{-1}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>.</p>
</li>
</ul>
<h3 id="序列密码安全性">序列密码安全性</h3>
<p>Golomb 对<strong>伪随机周期序列</strong>提出的 3 个随机性公设：</p>
<ul>
<li>在一个周期内，0 和 1 的个数相差至多为1，即{a<sub>i</sub>}中 0 和 1 出现的概率基本相同；</li>
<li>在一个周期内，长为 1 的游程占游程总数的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\dfrac {1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，长为 2 的游程占总数的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><msup><mn>2</mn><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\dfrac {1}{2^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，长为 i 的游程占总数的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><msup><mn>2</mn><mi>i</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">\dfrac {1}{2^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.750664em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，且等长的游程中 0 游程和 1 游程的个数相等，即 <strong>0 和 1 在序列的每一位置出现的概率相同</strong>；</li>
<li>异相自相关函数是一个常数，即<strong>通过对序列与其平移后的序列相比较，不能给出其他任何信息</strong>。</li>
</ul>
<p>序列密码相比分组密码的优点：</p>
<ol>
<li>在硬件实施上，序列密码的速度一般要比分组密码快，而且不需要有很复杂的硬件电路。</li>
<li>当缓冲不足或必须对收到字符进行逐一处理时，序列密码就显得更加必要和恰当。</li>
<li>序列密码有较理想的数学分析。</li>
<li>序列密码能较好地隐藏明文的统计特性。</li>
</ol>
<h3 id="常见的流密码">常见的流密码</h3>
<ol>
<li><code>RC4</code> - 基于非线性数组变换</li>
</ol>
<p>RC4 是一个典型的基于<strong>非线性数组变换</strong>的序列密码，是密钥长度可变、面向字节操作的、使用最为广泛的的序列密码之一；分析显示该密码的周期大于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>100</mn></msup></mrow><annotation encoding="application/x-tex">10^{100}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>。它以一个足够大的数组为基础，对其进行非线性变换，产生非线性的密钥流序列。<br>
优点：容易用软件实现，加解密速度快（大约比 DES 快 10 倍）</p>
<ol start="2">
<li><code>A5</code> - 基于 LFSR</li>
</ol>
<p>A5 算法已被应用于 GSM 通信系统中，用于加密从手机到基站的连接，以保护语音通信。一个 GSM 语言消息被转换成一系列的帧，每帧长 228 位，每帧用 A5 进行加密.<br>
A5 算法主要由<strong>三个长度不同的线性移位寄存器</strong>组成，即 A, B, C。其中 A 有 19 位，B 有 22 位，C 有 23 位. 移位由时钟控制的，且遵循<strong>择多</strong>的原则。即从每个寄存器中取出一个中间位，三个数中占多数的寄存器参加移位，其余的不移位。</p>
<h2 id="c6-hash-函数">C6 Hash 函数</h2>
<pre><code>* 清楚哈希函数的概念，思想、建立它的基础，在哪里会有具体应用
* md5 和 sha-1 不需要记忆算法，但是要清楚对数据的处理过程
* 对哈希函数的安全性能分析
</code></pre>
<p>Hash 函数常用于<strong>消息认证、口令的安全性、文件的完整性、数字签名</strong>等。</p>
<h3 id="hash-函数性质">Hash 函数性质</h3>
<ul>
<li><strong>数据压缩</strong>，可应用于<strong>任意长度</strong>的消息，变换为<strong>固定长度</strong>的输出；</li>
<li><strong>易于计算</strong>，对任意给定消息 x，计算 H(x) 比较<strong>容易</strong>，软硬件均可实现；</li>
<li><strong>单向性</strong>（抗原像性），已知 H(x) 找到 x 在计算上是不可行的；</li>
<li><strong>抗弱碰撞性</strong>（抗第二原像），对任意给定 x，找到 y ≠ x 且 H(x) = H(y) 在计算上是不可行的；</li>
<li><strong>抗强碰撞性</strong>，找到任意满足 H(x) = H(y) 的偶对 (x, y) 在计算上是不可行的；</li>
</ul>
<h3 id="md5">MD5</h3>
<p><strong>MD5 消息摘要算法</strong>（MD5 Message-Digest Algorithm），一种被广泛使用的密码散列函数，可以产生出一个 128-bit (16-byte，1-byte = 8-bit) 的散列值 (hash value).</p>
<p><code>MD5</code> 是输入不定长度信息，分组长度为 <strong>512-bit</strong>， 输出固定长度 <strong>128-bit</strong> 的算法。经过 <strong>4</strong> 轮次每轮次 <strong>16</strong> 步的程序流程，生成四个 32-bit 数据，最后联合起来成为一个 128-bit 散列。基本方式为，求余、取余、调整长度、与链接变量进行循环运算，得出结果。</p>
<h3 id="附加填充位">附加填充位</h3>
<ol>
<li>
<p><strong>填充消息</strong>：首先填充 1 个 1 和 若干个 0 使得消息长度（包括<strong>原始消息的长度</strong>和<strong>本次填充的长度</strong>）模 512 与 448 同余。<br>
<strong>★</strong> 需要特别注意的是，若原始消息长度刚好满足模 512 与 448 同余，则还需要填充 1 个 1 和 511 个 0 。</p>
</li>
<li>
<p><strong>补足长度</strong>：再将<strong>原始消息长度</strong>以 <code>64-bit</code>（小端序）表示附加在填充结果的后面，从而使得<strong>最终的长度</strong>（包括原始消息的长度、本次填充的长度和 64-bit 的消息长度）是 <code>512-bit</code> 的倍数。</p>
</li>
</ol>
<p><strong>☆</strong> Little-endian：<strong>低位字节</strong>存入<strong>低地址</strong>，<strong>高位字节</strong>存入<strong>高地址</strong>。</p>
<h3 id="sha-1">SHA-1</h3>
<p>分组长度为 <strong>512-bit</strong>，输出 <strong>160-bit</strong> 的消息摘要，有更强的抗穷举能力。</p>
<p>共 <strong>4</strong> 轮，每轮次 <strong>20</strong> 步。</p>
<p><strong>- 安全性 -</strong></p>
<ol>
<li>SHA-1 的消息摘要比 MD5 长 32-bit.</li>
<li>SHA-1 中，将 16 字的分组报文扩展为 80 字，因而对于每轮迭代，增加了输入的差异。</li>
<li>抗密码分析攻击的强度，SHA-1 似乎高于 MD5.</li>
</ol>
<p><strong>- 效率 -</strong></p>
<p>MD5 效率比 SHA-1 高。总的说来， SHA-1 的安全性是以牺牲效率为代价的.</p>
<h3 id="md5-安全性">MD5 安全性</h3>
<p>攻击者的目标：找到两个不同的消息映射为同一杂凑值。</p>
<p><strong>- 基本攻击方法 -</strong></p>
<ul>
<li>
<p><strong>穷举攻击</strong></p>
<p>最典型的方法是<strong>生日攻击</strong>：给定初值 H<sub>0</sub>=h(M)，寻找 M' ≠ M，使 h(M') = H<sub>0</sub>，MD5 算法抗密码分析的能力较弱，生日攻击所需代价是试验 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mn>64</mn></msup></mrow><annotation encoding="application/x-tex">2^{64}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span> 个消息。</p>
</li>
<li>
<p><strong>密码分析</strong></p>
<p>依赖于 Hash 函数的结构和代数性质分析，采用针对 Hash 函数弱性质的方法进行攻击，如<strong>中间相遇攻击</strong>、<strong>修正分组攻击</strong>和<strong>差分攻击</strong>等。</p>
</li>
</ul>
<h3 id="消息认证码">消息认证码</h3>
<p>消息认证是一个过程，用以验证接收消息的<strong>真实性</strong>（的确是由它所声称的实体发来的）和<strong>完整性</strong>（未被篡改、插入、删除），同时还用于验证消息的<strong>顺序性和时间性</strong>（未被重排、重放、延迟等）.</p>
<p>实现消息认证的两类常见手段：</p>
<ul>
<li>基于加密技术的消息认证</li>
<li>基于散列函数的消息认证</li>
</ul>
<p><strong>消息认证码</strong>(<code>MAC</code>，Message Authentication Code)或报文认证码是一种消息认证技术，利用消息和双方<strong>共享的密钥</strong>通过<strong>认证函数</strong>来生成一个固定长度的数据块，并将该数据块附加在消息后。</p>
<figure data-type="image" tabindex="13"><img src="https://3nd.xyz/post-images/move/2020-01-02-15-12-41.png" alt="" loading="lazy"></figure>
<h4 id="基于-des-的消息认证码">基于 DES 的消息认证码</h4>
<p>采用 DES 运算的<strong>密码分组链接模式</strong>（<code>CBC</code>），初始向量 IV 为 <code>0</code>，将需要认证的数据分为连续的 <code>64-bit</code> 分组。</p>
<h4 id="基于hash的认证码">基于Hash的认证码</h4>
<p><code>HMAC</code>：将散列函数嵌入到消息认证码的构造过程中，在安全协议 SSL 和 IPSec 中使用 HMAC 实现消息认证功能，对消息认证码的穷举攻击比对使用相同长度密钥的加密算法的穷举攻击更困难。</p>
<p><strong>- 应用 -</strong></p>
<p>通信双方 A 和 B 有一个共享密钥 K。当 A 有要发往 B 的消息时，发送方 A 利用共享密钥 K 计算 MAC，然后将消息和 MAC 一起发往预定的接收者 B.</p>
<p>在接收端 B ，使用相同的密钥 K 对收到的消息执行相同的计算并得出新的 MAC，将收到的 MAC 与计算得出的 MAC 进行比较：如果相同，则消息的确来自 A，且没有被更改过；如果不同，丢弃消息。</p>
<h2 id="c7-公钥密码">C7 公钥密码</h2>
<pre><code>* 了解椭圆曲线的思想
* rsa 算法过程进行计算，安全性能进行分析
* 离散对数，应用它进行签名和加密，不要求记住加密签名过程，但是要能够对他进行验证、计算、安全性分析
</code></pre>
<p>如何实现密钥的安全传输？有没有不需要安全信道的密码技术？</p>
<p><strong>- 公钥密码学概述 -</strong></p>
<p><strong>公钥密码学</strong>(Public Key Cryptography, <code>PKC</code>)</p>
<p>对称加密体制的不足 — <strong>签名和认证</strong>问题：对称密码体制中，通信双方<strong>共享密钥</strong>，因此：</p>
<ul>
<li>接收方可以伪造原文—不能实现<strong>鉴别认证</strong></li>
<li>发送方也可以否认—不能实现<strong>不可否认性</strong></li>
</ul>
<p>解决方案：公钥密码体制。</p>
<p><strong>公钥密码</strong>（非对称密码）：每个用户都分别拥有两个密钥：加密密钥(<strong>公钥</strong>)与解密密钥(<strong>私钥</strong>) ，两者并不相同，且由加密密钥得到解密密钥在计算上不可行。加密密钥是公开的。</p>
<figure data-type="image" tabindex="14"><img src="https://3nd.xyz/post-images/move/2020-01-02-15-37-09.png" alt="" loading="lazy"></figure>
<p>构造可行的不对称密码系统，关键是找到合适的数学函数 — <strong>单向陷门函数</strong>。</p>
<p><strong>单向陷门函数 𝒇</strong>：</p>
<ol>
<li>
<p>给出 𝑓 定义域中的任意元素 𝑥,计算 𝑓(𝑥) 是容易的；</p>
</li>
<li>
<p>给出 𝑦 = 𝑓(𝑥) 中的 𝑦，计算 𝑥：</p>
</li>
</ol>
<ul>
<li>若知道设计函数 𝑓 时结合进去的某种信息（称为陷门），则 𝑥 容易计算；</li>
<li>若不知道该<strong>陷门</strong>信息，则 𝑥 难以计算。</li>
</ul>
<h3 id="rsa-公钥密码体制">RSA 公钥密码体制</h3>
<p>该算法的数学基础是初等数论中的<strong>欧拉定理</strong>，其安全性基于<strong>大整数因子分解的困难性</strong>。</p>
<h4 id="密钥生成">密钥生成</h4>
<ol>
<li>
<p>选择两个大素数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑝</mi><mi mathvariant="normal">≠</mi><mi>𝑞</mi></mrow><annotation encoding="application/x-tex">𝑝 ≠ 𝑞</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>，需要保密，步骤 4 以后建议销毁).</p>
</li>
<li>
<p>计算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑛</mi><mo>=</mo><mi>𝑝</mi><mo>×</mo><mi>𝑞</mi></mrow><annotation encoding="application/x-tex">𝑛 = 𝑝 × 𝑞</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>φ</mi><mo>(</mo><mi>n</mi><mo>)</mo><mo>=</mo><mo>(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo>)</mo><mo>(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">\varphi(n) = (p-1)(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>.</p>
</li>
<li>
<p>选择整数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑒</mi></mrow><annotation encoding="application/x-tex">𝑒</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span></span></span></span> 使 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>φ</mi><mo>(</mo><mi>n</mi><mo>)</mo><mi mathvariant="normal">，</mi><mi>𝑒</mi><mo>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">(\varphi(n)，𝑒) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>𝑒</mi><mo>&lt;</mo><mi>φ</mi><mo>(</mo><mi>𝑛</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">1 &lt; 𝑒 &lt; \varphi(𝑛)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>.</p>
</li>
<li>
<p>计算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑑</mi></mrow><annotation encoding="application/x-tex">𝑑</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>，使 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑑</mi><mo>=</mo><msup><mi>𝑒</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext> </mtext><mi>𝑚</mi><mi>𝑜</mi><mi>𝑑</mi><mtext> </mtext><mi>φ</mi><mo>(</mo><mi>𝑛</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">𝑑 = 𝑒^{-1} \ 𝑚𝑜𝑑 \ \varphi(𝑛)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>.</p>
</li>
</ol>
<p>得到：公钥为 {𝑒, 𝑛}； 私钥为 {𝑑} .</p>
<ul>
<li>加密(用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝒆</mi><mi mathvariant="normal">，</mi><mi>𝒏</mi></mrow><annotation encoding="application/x-tex">𝒆，𝒏</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord boldsymbol" style="margin-right:0.085em;">e</span><span class="mord cjk_fallback">，</span><span class="mord boldsymbol" style="margin-right:0.09426em;">n</span></span></span></span>)： 明文 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑀</mi><mo>&lt;</mo><mi>𝑛</mi></mrow><annotation encoding="application/x-tex">𝑀 &lt; 𝑛</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>， 密文 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝐶</mi><mo>=</mo><msup><mi>𝑀</mi><mi>𝑒</mi></msup><mtext> </mtext><mo>(</mo><mi>𝑚</mi><mi>𝑜</mi><mi>𝑑</mi><mtext> </mtext><mi>𝑛</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">𝐶 = 𝑀^𝑒 \ (𝑚𝑜𝑑 \ 𝑛)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>.</li>
<li>解密(用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝒅</mi><mi mathvariant="normal">，</mi><mi>𝒏</mi></mrow><annotation encoding="application/x-tex">𝒅，𝒏</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord boldsymbol" style="margin-right:0.10861em;">d</span><span class="mord cjk_fallback">，</span><span class="mord boldsymbol" style="margin-right:0.09426em;">n</span></span></span></span>)： 密文 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝐶</mi></mrow><annotation encoding="application/x-tex">𝐶</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>， 明文 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑀</mi><mo>=</mo><msup><mi>𝐶</mi><mi>𝑑</mi></msup><mtext> </mtext><mo>(</mo><mi>𝑚</mi><mi>𝑜</mi><mi>𝑑</mi><mtext> </mtext><mi>𝑛</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">𝑀 = 𝐶^𝑑 \ (𝑚𝑜𝑑 \ 𝑛)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>.</li>
</ul>
<h4 id="快速幂">快速幂</h4>
<p>如何快速的计算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>𝒂</mi><mi>𝒎</mi></msup><mtext> </mtext><mo>(</mo><mi>𝒎</mi><mi>𝒐</mi><mi>𝒅</mi><mtext> </mtext><mi>𝒏</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">𝒂^𝒎 \ (𝒎𝒐𝒅 \ 𝒏)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord boldsymbol" style="margin-right:0.09426em;">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6741079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord boldsymbol mtight" style="margin-right:0.09426em;">m</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord boldsymbol" style="margin-right:0.09426em;">m</span><span class="mord boldsymbol" style="margin-right:0.07861em;">o</span><span class="mord boldsymbol" style="margin-right:0.10861em;">d</span><span class="mspace"> </span><span class="mord boldsymbol" style="margin-right:0.09426em;">n</span><span class="mclose">)</span></span></span></span>？</p>
<p>将 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑚</mi></mrow><annotation encoding="application/x-tex">𝑚</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 表示为二进制形式 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>k</mi></msub><msub><mi>b</mi><mrow><mi>k</mi><mi mathvariant="normal">−</mi><mn>1</mn></mrow></msub><mo>…</mo><msub><mi>b</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">b_{k} b_{k−1} … b_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，即：</p>
<p>$ m = b_{k}2^{k} + b_{k-1}2^{k-1} + ... + b_{1}2 + b_0$</p>
<p>如：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>19</mn><mo>=</mo><mn>1</mn><mo>×</mo><msup><mn>2</mn><mn>4</mn></msup><mo>+</mo><mn>0</mn><mo>×</mo><msup><mn>2</mn><mn>3</mn></msup><mo>+</mo><mn>0</mn><mo>×</mo><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mn>1</mn><mo>×</mo><msup><mn>2</mn><mn>1</mn></msup><mo>+</mo><mn>1</mn><mo>×</mo><msup><mn>2</mn><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">19 = 1×2^4 + 0×2^3 + 0×2^2 + 1×2^1 + 1×2^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span>，所以：</p>
<figure data-type="image" tabindex="15"><img src="https://3nd.xyz/post-images/move/2020-01-02-16-04-27.png" alt="" loading="lazy"></figure>
<pre><code class="language-py">c = 1
c = c * c mod n
if b == 1:
    c = c * a mod n
</code></pre>
<p>注意：所有的乘法或乘方运算之后都有一个<strong>模运算</strong>。</p>
<h4 id="求模逆">求模逆</h4>
<figure data-type="image" tabindex="16"><img src="https://3nd.xyz/post-images/move/2020-01-02-23-24-57.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="17"><img src="https://3nd.xyz/post-images/move/2020-01-02-23-24-28.png" alt="" loading="lazy"></figure>
<h4 id="攻击方式">攻击方式</h4>
<ol>
<li><strong>针对 n 分解的攻击</strong></li>
</ol>
<ul>
<li><strong>试除法</strong><br>
完全尝试所有小于 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt {n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">n</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span> 的素数；</li>
<li><strong>因式分解法</strong>
<ul>
<li>二次筛法</li>
<li>连分数法</li>
<li>椭圆曲线筛法</li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>循环攻击</strong></li>
</ol>
<ul>
<li>设 m 为明文，(n, e) 为公钥，密文 c = m<sup>e</sup> mod n
<ul>
<li>攻击者得到密文 c 后，对 c 依次进行如下变换：<br>
c<sub>1</sub> = c<sup>e</sup> mod n<br>
c<sub>2</sub> = c<sub>1</sub><sup>e</sup> mod n<br>
……    ……<br>
c<sub>k</sub> = c<sub>k-1</sub><sup>e</sup> mod n<br>
c<sub>k+1</sub> = c<sub>k</sub><sup>e</sup> mod n</li>
<li>k+1次迭代后，如果 c<sub>k+1</sub> = c，由 c = m<sup>e</sup> mod n，则 c<sub>k</sub> = m，获得明文。</li>
</ul>
</li>
<li>避免循环攻击：
<ul>
<li>ord<sub>n</sub>(m) 要大，且 <strong>φ(ord<sub>n</sub>(m))要有大的素因子</strong>。</li>
<li>ord<sub>n</sub>(m) 是 φ(n) 的因子，所以需要 <strong>p-1 和 q-1 都有大的因子</strong>。</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>共模攻击</strong></li>
</ol>
<p>m 为明文，两用户的公钥分别为 e<sub>1</sub> 和 e<sub>2</sub>，且互素，共同的模数 n，两个密文分别为 c<sub>1</sub> 和 c<sub>2</sub>，攻击者知道 n，e<sub>1</sub>，e<sub>2</sub>，c<sub>1</sub> 和 c<sub>2</sub>。</p>
<ul>
<li>恢复明文 m：由欧几里得算法可找出 r 和 s 满足 <strong>re<sub>1</sub>+se<sub>2</sub>=1</strong>，假定 r 是负数，那么 <strong>(c<sub>1</sub><sup>-1</sup>)<sup>-r</sup> c<sub>2</sub><sup>s</sup> = m<sup>re<sub>1</sub>+se<sub>2</sub></sup> = m mod n</strong>，无需私钥 d 即可获得明文 m。</li>
<li>防御：使用 RSA 公钥加密的通信中，不同用户的密钥不能有相同的模值。</li>
</ul>
<ol start="4">
<li><strong>低加密指数攻击</strong></li>
</ol>
<p>小的公钥 e 可以加快加密的速度，过小的公钥则容易受到攻击。<br>
如果 3 个用户都使用 <code>3</code> 作为公钥，对同一个明文 m 加密，则 c<sub>1</sub> = m<sup>3</sup> mod n<sub>1</sub>，c<sub>2</sub> = m<sup>3</sup> mod n<sub>2</sub>，c<sub>3</sub> = m<sup>3</sup> mod n<sub>3</sub>，且 n<sub>1</sub>，n<sub>2</sub>，n<sub>3</sub> 互素，m 小于模数.<br>
由<strong>中国剩余定理</strong>可从 c<sub>1</sub>，c<sub>2</sub>，c<sub>3</sub> 计算出 c，且 <strong>c = m<sup>3</sup>mod (n<sub>1</sub>n<sub>2</sub>n<sub>3</sub>)，m = c<sup>1/3</sup></strong><br>
如果采用不同的 n，相同的 e，对 e(e+1)/2 个线性相关的消息加密，系统就会受到威胁，所以一般选取 16 位以上的素数(速度快且可防止攻击).<br>
防御：对短消息，用<strong>随机数填充</strong>以保证 m<sup>e</sup> ≠ m<sup>e</sup> mod n，从而杜绝低加密指数攻击.</p>
<ol start="5">
<li><strong>时间攻击</strong></li>
</ol>
<p>主要针对 RSA 核心运算是非常耗时的<strong>模乘</strong>，只要能够精确监视 RSA 的解密过程，就能估算出私有密钥 𝑑。</p>
<h3 id="elgamal-加密方案">Elgamal 加密方案</h3>
<p>安全性基于<strong>有限域上的离散对数问题(DLP)</strong>：</p>
<p>设 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> 至少是 150 位的十进制素数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 有大素因子。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">Z_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 为有限域，若 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">Z_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> 中的<strong>本原元</strong>/生成元/原根，有：<br>
<span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \&lt; at position 11: {Z_p}^* = \̲&lt;̲g\&gt;, \ 𝛽∈{Z_p}…'>{Z_p}^* = \&lt;g\&gt;, \ 𝛽∈{Z_p}^*</span>，求唯一的整数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>(</mo><mn>0</mn><mo>≤</mo><mi>𝑎</mi><mo>≤</mo><mi>𝑝</mi><mi mathvariant="normal">−</mi><mn>2</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">a(0 ≤ 𝑎 ≤ 𝑝−2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord">−</span><span class="mord">2</span><span class="mclose">)</span></span></span></span>，满足 <span class='katex-error' title='Error: Font metrics not found for font: .'>𝑔^𝑎 = 𝛽 \ (𝑚𝑜𝑑 \ 𝑝)</span>，记为 $ a = \log_{g}𝛽$.</p>
<p>一般来说，求解 𝒂 在计算上是困难的.</p>
<h4 id="密钥生成-2">密钥生成</h4>
<p>选取大素数 $p, g∈{Z_p}^* $ 是一个生成元，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo separator="true">,</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">p, g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> 作为系统参数所有用户共享，系统中每个用户 U 都随机挑选整数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑥</mi><mi mathvariant="normal">，</mi><mn>2</mn><mo>≤</mo><mi>𝑥</mi><mo>≤</mo><mi>𝑝</mi><mi mathvariant="normal">－</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">𝑥，2 ≤ 𝑥 ≤ 𝑝－2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">x</span><span class="mord cjk_fallback">，</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord cjk_fallback">－</span><span class="mord">2</span></span></span></span>，并计算：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑦</mi><mo>=</mo><msup><mi>𝑔</mi><mi>𝑥</mi></msup><mtext> </mtext><mo>(</mo><mi>𝑚</mi><mi>𝑜</mi><mi>𝑑</mi><mtext> </mtext><mi>𝑝</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">𝑦=𝑔^𝑥\ (𝑚𝑜𝑑 \ 𝑝)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑦</mi><mo separator="true">,</mo><mi>𝑝</mi><mo separator="true">,</mo><mi>𝑔</mi></mrow><annotation encoding="application/x-tex">𝑦, 𝑝, 𝑔</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> 作为用户 U 的<strong>公钥</strong>，而 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>𝑥</mi></mrow><annotation encoding="application/x-tex">𝑥</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 作为用户 U 的<strong>私钥</strong>。</p>
<p><strong>- 加密 -</strong></p>
<ol>
<li>
<p>用户 A 先把明文 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 编码为一个在 0 到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 之间的整数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>；</p>
</li>
<li>
<p>用户 A 挑选一个秘密随机数 𝑟 ( 2 ≤ 𝑟 ≤ 𝑝－2 )，并计算：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mi mathvariant="normal">＝</mi><msup><mi>𝑔</mi><mi>𝑟</mi></msup><mtext> </mtext><mo>(</mo><mi>𝑚</mi><mi>𝑜</mi><mi>𝑑</mi><mtext> </mtext><mi>𝑝</mi><mo>)</mo><mi mathvariant="normal">；</mi><msub><mi>c</mi><mn>2</mn></msub><mi mathvariant="normal">＝</mi><mi>𝑚</mi><mtext> </mtext><msup><mi>𝑦</mi><mi>𝑟</mi></msup><mtext> </mtext><mo>(</mo><mi>𝑚</mi><mi>𝑜</mi><mi>𝑑</mi><mtext> </mtext><mi>𝑝</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">c_1 ＝ 𝑔^𝑟 \ (𝑚𝑜𝑑 \ 𝑝)；c_2 ＝ 𝑚 \ 𝑦^𝑟 \ (𝑚𝑜𝑑 \  𝑝)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">＝</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span><span class="mclose">)</span><span class="mord cjk_fallback">；</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">＝</span><span class="mord mathdefault">m</span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span>；</p>
</li>
<li>
<p>用户 A 把二元组 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>c</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(c_{1}, \ c_{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 作为密文传送给用户 B。</p>
</li>
</ol>
<p><strong>- 解密 -</strong></p>
<p>用户 B 接收到密文二元组 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>c</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(c_{1}, \ c_{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 后，做解密计算: <span class='katex-error' title='ParseError: KaTeX parse error: Can&#039;t use function &#039;\(&#039; in math mode at position 9: m = c_2 \̲(̲{c_{1\}\}^{x}\)…'>m = c_2 \({c_{1\}\}^{x}\)^{-1}\ mod \ p</span>.</p>
<p>算法的正确性：</p>
<figure data-type="image" tabindex="18"><img src="https://3nd.xyz/post-images/move/2020-01-02-17-36-31.png" alt="" loading="lazy"></figure>
<h4 id="算法特点">算法特点</h4>
<ol>
<li>
<p><strong>非确定性</strong>：密文依赖于加密过程中用户 A 选择的随机数 <code>r</code> ，加密相同的明文可能会产生不同密文 — <strong>概率加密</strong>.</p>
</li>
<li>
<p><strong>密文空间大于明文空间</strong>：明文空间为 <span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \* at position 12: {Z_{p\}\}^{\̲*̲}'>{Z_{p\}\}^{\*}</span>，而密文空间为 <span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \* at position 12: {Z_{p\}\}^{\̲*̲}'>{Z_{p\}\}^{\*}</span> * <span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \* at position 12: {Z_{p\}\}^{\̲*̲}'>{Z_{p\}\}^{\*}</span>.</p>
</li>
</ol>
<h4 id="安全性">安全性</h4>
<p><strong>同态</strong>：假设攻击者获得了消息 m 的密文 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>c</mi><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(c_1, \ c_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, 攻击者随机选择 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">r&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 和消息 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>m</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">m&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，并计算：</p>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: Can&#039;t use function &#039;$&#039; in math mode at position 33: …r&#039;}) \ mod \ p $̲$$$c_2&#039; = (c_2 …'>c_1&#039; = (c_1 ∗ g^{r&#039;}) \ mod \ p $$$$c_2&#039; = (c_2 ∗ y^{r&#039;} ∗ m&#039;) \ mod \ p $$ 攻击者将构造的新密文 $(c_1&#039;, c_2&#039;)$ 送解密机，则返回明文: $(m ∗ m&#039;)\ mod \ p$ 从而得到密文 c 的明文 m.

计算离散对数的方法：

- 大步-小步法（Giant-step Baby-step）

- 指数积分法（Index Calculus） — 更有效，亚指数时间算法

### 椭圆曲线密码体制

安全性基于 **椭圆曲线上的离散对数问题**，ECC 可用于密钥交换、数字签名和加密。

1. 椭圆曲线加密(`ECC`)最大的优点就是使用比 RSA 和 Elgamal **短得多的密钥**得到相同的安全性，此外， ECC 得到的密文和签名也比较短，因此可以减少处理负荷，使公钥密码的应用领域得到拓展。

2. 很多情况下，ECC 比其他公钥算法都具有**性能优势**，与其他公钥方案相比，ECC 的应用正在慢慢普及，大量的新应用（尤其是嵌入式平台）都是用椭圆曲线密码学。


## C8 数字签名

```
* 基于RSA的数字签名方案
* 基于离散对数的数字签名方案
```

**- 数字签名的目的 -**

保证信息的**完整性**和**真实性**，即消息没有被篡改，而且签名也没有被篡改，消息只能始发于所声称的一方。

一个完善的签名方案应满足以下三个条件：

1. **不可否认性**：签名者事后不能否认或抵赖自己的签名
2. **不可伪造性**：其他任何人均不能伪造签名，也不能对接收或发送的信息进行篡改、伪造和冒充
3. **公正的仲裁**：若当事双方对签名真伪发生争执时，能通过公正的仲裁者验证签名来确定其真伪


### 基于 RSA 的数字签名方案

**- 签名算法 -**

设 M 为明文，$K_{eA}=(e, \ n)$ 是 A 的公钥，$K_{dA}=(d, \ p, \ q, \ \varphi(n))$ 是 A 的保密的私钥。

则 A 对 M 的签名过程是：

$ S_{A} = D(M, K_{dA}) = M^{d} \ mod \ n $

验证签名的过程：

$E(S_{A}, \ K_{eA}) = (M^{d})^{e} \ mod \ n = M $


### 基于离散对数的 EIGamal 签名方案

**- 签名过程 -**

**系统初始化过程**：公钥为 (p, g, y)，私钥为 x (1 ≤ x &lt; p-1)，其中 $y = g^x \ mod \ p$

**签名过程**：

1. 选择随机数 $k ∈ {Z_p}^*$，且 $k$ 与 $(p-1)$ 互素；

2. 首先计算消息的 Hash 值 H(M)，然后计算：

$$r = g^k \ mod \ p$$$$s = (H(M) - xr)k^{-1} \ (mod \ p-1)</p>
<ol start="3">
<li>将 (r, s) 作为签名，与 M 一起发送给接收方。</li>
</ol>
<p><strong>- 验证签名的过程 -</strong></p>
<p>验接收方收到  M 与其签名 (r, s) 后：</p>
<ul>
<li>计算消息 M 的 Hash 值 H(M)；</li>
<li>验证公式 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mi>r</mi></msup><msup><mi>r</mi><mi>s</mi></msup><mi mathvariant="normal">＝</mi><msup><mi>g</mi><mrow><mi>H</mi><mo>(</mo><mi>M</mi><mo>)</mo></mrow></msup><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">y^rr^s＝ g ^{H(M)} \ mod \ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824399999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">＝</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">p</span></span></span></span> ，成立则确认 (r, s) 为有效签名，否则认为签名是伪造的.</li>
</ul>
<pre><code>★求模逆

LFSR 正逆向
 逆向 给出序列求解反馈函数

对称密码 

分组密码
\+ 输入长度分组长度密钥长度
\+ DES AES
\+ Festail网络结构 
   会画 
   证明第一步是对和变换 f(f(x))=x
   S盒代换
   2DES 112-bits-&gt;57-bits
   互补性
\+ AES 
   128-bit 4c4r 基本流程 总体结构
   列混合 模不可约多项式乘法 2hex乘
   密钥生成子密钥
\+ IDEA SM4 
   简单要求 分组/密钥长度/轮次
\+ 5种工作模式 简单分析(加解密/效率)

\+ Hash函数 
    需要满足的性质 单向函数 架构
\+ MD5 SHA-1 ★填充 整数的二进制表示
\+ 2种消息认证模式 DES/Hash
</code></pre>

                  </div>
                  <div class="toc-container">
                    <div style="position: sticky;
                    top: 20px;">
                    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#c0-%E8%80%83%E8%AF%95%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF">C0 考试相关信息</a></li>
<li><a href="#c1-%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A6%82%E8%BF%B0">C1 密码学概述</a></li>
<li><a href="#c3-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E4%BD%93%E5%88%B6">C3 古典密码体制</a>
<ul>
<li><a href="#%E4%BB%A3%E6%8D%A2%E5%AF%86%E7%A0%81">代换密码</a></li>
<li><a href="#%E7%BD%AE%E6%8D%A2%E5%AF%86%E7%A0%81">置换密码</a></li>
</ul>
</li>
<li><a href="#c4-%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81">C4 分组密码</a>
<ul>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86-des">数据加密标准 - DES</a>
<ul>
<li><a href="#%E5%88%9D%E5%A7%8B%E7%BD%AE%E6%8D%A2ip%E9%80%86%E5%88%9D%E5%A7%8B%E7%BD%AE%E6%8D%A2ipsup-1sup">初始置换IP/逆初始置换IP<sup>-1<sup></a></li>
<li><a href="#16-%E8%BD%AE%E8%BF%AD%E4%BB%A3">16 轮迭代</a></li>
<li><a href="#f-%E5%87%BD%E6%95%B0"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> 函数</a></li>
<li><a href="#%E5%AF%86%E9%92%A5%E7%BC%96%E6%8E%92">密钥编排</a></li>
<li><a href="#des-%E5%AE%89%E5%85%A8%E6%80%A7">DES 安全性</a></li>
</ul>
</li>
<li><a href="#%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86-aes">高级加密标准 - AES</a>
<ul>
<li><a href="#%E5%AD%97%E8%8A%82%E4%BB%A3%E6%8D%A2%E5%B1%82s-box">字节代换层(S-Box)</a></li>
<li><a href="#shiftrows-%E8%A1%8C%E7%A7%BB%E4%BD%8D">ShiftRows 行移位</a></li>
<li><a href="#mixcolumn-%E5%88%97%E6%B7%B7%E5%90%88">MixColumn 列混合</a></li>
<li><a href="#%E5%AF%86%E9%92%A5%E5%8A%A0%E6%B3%95%E5%B1%82-%E8%BD%AE%E5%AF%86%E9%92%A5%E5%8A%A0">密钥加法层 轮密钥加</a></li>
<li><a href="#%E5%AF%86%E9%92%A5%E6%89%A9%E5%B1%95">密钥扩展</a></li>
</ul>
</li>
<li><a href="#%E5%85%B8%E5%9E%8B%E7%9A%84%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81">典型的分组密码</a></li>
<li><a href="#%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F">工作模式</a></li>
</ul>
</li>
<li><a href="#c5-%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81">C5 序列密码</a>
<ul>
<li><a href="#%E7%BA%BF%E6%80%A7%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8-lfsr">线性反馈移位寄存器 - LFSR</a></li>
<li><a href="#%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81%E5%AE%89%E5%85%A8%E6%80%A7">序列密码安全性</a></li>
<li><a href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%B5%81%E5%AF%86%E7%A0%81">常见的流密码</a></li>
</ul>
</li>
<li><a href="#c6-hash-%E5%87%BD%E6%95%B0">C6 Hash 函数</a>
<ul>
<li><a href="#hash-%E5%87%BD%E6%95%B0%E6%80%A7%E8%B4%A8">Hash 函数性质</a></li>
<li><a href="#md5">MD5</a></li>
<li><a href="#%E9%99%84%E5%8A%A0%E5%A1%AB%E5%85%85%E4%BD%8D">附加填充位</a></li>
<li><a href="#sha-1">SHA-1</a></li>
<li><a href="#md5-%E5%AE%89%E5%85%A8%E6%80%A7">MD5 安全性</a></li>
<li><a href="#%E6%B6%88%E6%81%AF%E8%AE%A4%E8%AF%81%E7%A0%81">消息认证码</a>
<ul>
<li><a href="#%E5%9F%BA%E4%BA%8E-des-%E7%9A%84%E6%B6%88%E6%81%AF%E8%AE%A4%E8%AF%81%E7%A0%81">基于 DES 的消息认证码</a></li>
<li><a href="#%E5%9F%BA%E4%BA%8Ehash%E7%9A%84%E8%AE%A4%E8%AF%81%E7%A0%81">基于Hash的认证码</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#c7-%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81">C7 公钥密码</a>
<ul>
<li><a href="#rsa-%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E4%BD%93%E5%88%B6">RSA 公钥密码体制</a>
<ul>
<li><a href="#%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90">密钥生成</a></li>
<li><a href="#%E5%BF%AB%E9%80%9F%E5%B9%82">快速幂</a></li>
<li><a href="#%E6%B1%82%E6%A8%A1%E9%80%86">求模逆</a></li>
<li><a href="#%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F">攻击方式</a></li>
</ul>
</li>
<li><a href="#elgamal-%E5%8A%A0%E5%AF%86%E6%96%B9%E6%A1%88">Elgamal 加密方案</a>
<ul>
<li><a href="#%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90-2">密钥生成</a></li>
<li><a href="#%E7%AE%97%E6%B3%95%E7%89%B9%E7%82%B9">算法特点</a></li>
<li><a href="#%E5%AE%89%E5%85%A8%E6%80%A7">安全性</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                  </div>
                  </div>
                </div>
          </article>
        </div>

        
          <div class="nearby-post" style="padding: 24px 32px;">
            <div class="prev-post" style="float: left;">
              <div class="aaa" style="
              margin-bottom: 24px;
              color: #343a40;
              font-weight: lighter;text-align: left;">上一篇</div>
              <a href="https://3nd.xyz/post/2020-01-05-Java-Course-Review/">
                <h3 class="post-title" style="text-align: left;">
                  Java Course Review Note
                </h3>
              </a>
            </div>
            <div class="next-posts" style="float: right;">
              <div class="aaa" style="
              margin-bottom: 24px;
              color: #343a40;
              font-weight: lighter; text-align: right;">下一篇</div>
              <a href="https://3nd.xyz/post/2019-12-25-Data-Encryption-Standard-DES/">
                <h3 class="post-title" style="
                text-align: right;">
                  Data Encryption Standard - DES
                </h3>
              </a>
            </div>
          </div>
          

                

                                <div class="site-footer">
  
  <a class="rss" href="https://3nd.xyz/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

    </div>
  </div>

  <script>
    hljs.highlightAll();

    let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

    // This should probably be throttled.
    // Especially because it triggers during smooth scrolling.
    // https://lodash.com/docs/4.17.10#throttle
    // You could do like...
    // window.addEventListener("scroll", () => {
    //    _.throttle(doThatStuff, 100);
    // });
    // Only not doing it here to keep this Pen dependency-free.

    window.addEventListener("scroll", event => {
      let fromTop = window.scrollY;

      mainNavLinks.forEach((link, index) => {
        let section = document.getElementById(decodeURI(link.hash).substring(1));
        let nextSection = null
        if (mainNavLinks[index + 1]) {
          nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
        }
        if (section.offsetTop <= fromTop) {
          if (nextSection) {
            if (nextSection.offsetTop > fromTop) {
              link.classList.add("current");
            } else {
              link.classList.remove("current");
            }
          } else {
            link.classList.add("current");
          }
        } else {
          link.classList.remove("current");
        }
      });
    });
  </script>
<script src="/media/view-support.js"></script>
<script>
  window.Lazyload.js(['https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js', '//cdn.jsdelivr.net/npm/leancloud-storage@3.13.2/dist/av-min.js'], function () {
    var pageview = window.pageview(AV, {
      appId: 'HRVNDkHV80Fpk9M8c5GQqjwy-gzGzoHsz',
      appKey: 'nsyqncNCSWSOkkns1wvDlUrh',
      appClass: 'Gridea',
    });
    $('.page-view').each(function () {
      var $this = $(this);
      var key = $this.attr('key');
      var title = $this.attr('title');
      pageview.increase(key, title, function(view) {
        $("[key='" + key +"']").text(view+' views');
      });
    });
  });
</script>

</body>

</html>